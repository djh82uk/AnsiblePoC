- name: Installing Putty Client MSI 
  hosts: all
  name: "Installing Putty Client MSI"
  tasks: 
    -
      name: Create directory structure
      win_file:
        path: "C:\\ansible_tools"
        state: directory
    - 
      name: "Copy my Installer"
      win_copy: 
        dest: "C:\\ansible_tools\\putty-64bit-0.74-installer.msi"
        src: /opt/tools/putty-64bit-0.74-installer.msi
    - 
      name: "Install MSI"
      win_package: 
        path: "C:\\ansible_tools\\putty-64bit-0.74-installer.msi"
        state: present
    - 
      name: Install all critical and security updates
      win_updates:
        category_names:
        - CriticalUpdates
        - SecurityUpdates
        state: installed
      register: update_result
