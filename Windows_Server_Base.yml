- name: Installing Putty Client MSI 
  hosts: all
  name: "Installing Putty Client MSI"
  tasks: 
    - 
      name: "Create a mapped drive that requires authentication"
      win_mapped_drive: 
        letter: T
        path: \\ansiblestg001.file.core.windows.net\tools
        state: present
      vars:
    # become is required to save and retrieve the credentials in the task
        ansible_become: yes
        ansible_become_method: runas
        ansible_become_user: '{{ ansible_user }}'
        ansible_become_pass: '{{ ansible_password }}'

    - 
      name: "Copy my Installer"
      win_copy: 
        remote_src: yes
        dest: "C:\\ansible_tools\\putty-64bit-0.74-installer.msi"
        src: "T:\\putty-64bit-0.74-installer.msi"
    - 
      name: "Install MSI"
      win_package: 
        path: "C:\\ansible_tools\\putty-64bit-0.74-installer.msi"
        state: present
    - 
      name: Install all critical and security updates
      win_updates:
        category_names:
        - CriticalUpdates
        - SecurityUpdates
        state: installed
      register: update_result
